# Story Name in Test Case Results - Feature Update

## Overview
Added Jira story name tracking to test case results. When generating tests for multiple stories, each test case now displays which story it belongs to in the frontend table and downloaded files.

## What Changed

### 1. **Data Model Updates**
- **TestCase Interface** (`frontend/src/types.ts`)
  - Added optional `storyName?: string` field
  - Tracks which story each test case originates from

- **TestCaseSchema** (`backend/src/schemas.ts`)
  - Updated Zod schema to include `storyName` field
  - Validates story name in test case responses

### 2. **Backend - Prompt Engineering**
- **System Prompt** (`backend/src/prompt.ts`)
  - Updated schema documentation to include `storyName` field
  - Added guideline: "If multiple stories, include the story name/title in the storyName field so test cases are tracked with their source"

- **Multi-Story Prompt** (`buildMultiPrompt()`)
  - Enhanced instructions to emphasize setting `storyName` for each test case
  - Added explicit instruction: "For EACH test case generated, set the storyName field to the story's title so test cases are correctly associated with their source stories"

### 3. **Frontend - UI Updates**
- **Results Table** (`frontend/src/App.tsx`)
  - Added new "Story Name" column between "Test Case ID" and "Title"
  - Displays `testCase.storyName` or 'N/A' if not provided
  - Styled with italic grey text for visual distinction
  - Updated table headers and column count from 4 to 5 columns

- **Expanded Details**
  - Updated `colSpan` from 4 to 5 to match new column layout

### 4. **Export Formats**
- **CSV Export** (`frontend/src/downloadUtils.ts`)
  - Added "Story Name" column after "Test Case ID"
  - New column header: `Test Case ID,Story Name,Title,Category,Expected Result,Steps,Test Data`
  - Includes story name (or 'N/A') for each test case

- **Excel Export** (`frontend/src/downloadUtils.ts`)
  - Added "Story Name" column (width: 25)
  - Maintains proper column alignment
  - Updated column widths to accommodate new field

## How It Works

### Single Story Generation
When generating tests for a single story:
- `storyName` may be empty (generated by single-story prompt)
- Table displays 'N/A' for story name
- Focus remains on the test cases

### Multi-Story Generation
When generating tests for multiple selected stories:
1. Frontend sends array of selected stories to backend
2. Backend prompt instructs LLM to include story title in each test case's `storyName` field
3. LLM generates test cases with story names populated
4. Frontend displays test cases grouped by story name
5. Downloads include story name for easy identification

## Example Output

### Table Display
```
Test Case ID | Story Name                    | Title                      | Category   | Expected Result
TC-001       | User Login Story             | Valid credentials         | Positive   | User logged in
TC-002       | User Login Story             | Invalid password          | Negative   | Login fails
TC-003       | User Profile Update          | Update profile picture    | Positive   | Picture updated
TC-004       | User Profile Update          | Upload large file         | Edge       | Error shown
```

### CSV Download
```
Story Title,Multi-Story Generation
Test Case ID,Story Name,Title,Category,Expected Result,Steps,Test Data
TC-001,"User Login Story","Valid credentials","Positive","User logged in","Enter email | Enter password | Click login | Verify dashboard","user@example.com"
```

### Excel Download
- New column "Story Name" added between ID and Title
- All data properly formatted and aligned
- Column widths optimized for readability

## Testing Checklist

- [ ] Single story generation - story name displays as 'N/A'
- [ ] Multi-story generation - each test case shows correct story name
- [ ] CSV download includes story name column
- [ ] Excel download includes story name column
- [ ] Story names in downloads are readable and properly formatted
- [ ] Table layout remains responsive
- [ ] Expanded test steps view works correctly with new column layout

## Notes

- Story names are populated by the LLM based on prompt instructions
- Backward compatible: existing test cases without `storyName` show 'N/A'
- Column order: ID → Story Name → Title → Category → Expected Result
- Story name field is optional for flexibility with different generation modes

## Related Documentation

- [JIRA_INTEGRATION.md](JIRA_INTEGRATION.md) - Jira connection and multi-story generation
- [IMPLEMENTATION_SUMMARY.md](IMPLEMENTATION_SUMMARY.md) - Technical architecture
- [QUICK_START.md](QUICK_START.md) - Quick reference guide
